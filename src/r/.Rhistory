plots_list <- list()
#Change grant_data name to the target file used
target_data <- read.table("../../../data/grant_data16.tsv", header=TRUE)
target_data <- filter(target_data, species == "protein1" | species == "protein2" | species == "protein3")
target_line_plot <-  ggplot(target_data, aes(fill=species, color=species, x=time, y=transcript)) + geom_line(stat="identity") + ggtitle("Target Genome Function") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
plots_list[[1]] <- target_line_plot
#Determines if there are too many accepted mutations and, if so, only display the last 20 that were accepted
starting_point <- 1
if (length(best_files) > 20){
starting_point <- length(best_files) - 20
}
plots_start <- 1
#Creates plots for each accepted mutation
for(i in starting_point:length(best_files)){
plots_start <- plots_start + 1
best <- "best"
best_plot <- "best_plot"
evolution_title <- "Genome Evolution "
plot_title <- paste(evolution_title, i, sep="")
file_name <- assign(paste(best, i, sep=""), read.table(best_files[i], fill=TRUE, header=TRUE))
file_name <- filter(file_name, species == "protein1" | species == "protein2" | species == "protein3")
plot_name <- assign(paste(best_plot, i, sep=""), ggplot(file_name, aes(fill=species, color=species, x=time, y=transcript)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black")) + geom_line(stat="identity") + ggtitle(plot_title))
plot <- ggplot(file_name, aes(fill=species, color=species, x=time, y=transcript)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black")) + geom_line(stat="identity") + ggtitle(plot_title)
plots_list[[plots_start]] <- plot
}
#Outputs file with the generated plots
evo_plot <- grid.arrange(grobs=plots_list, nrow=ceiling(length(plots_list) / 2), ncol=3, top="Evolutionary Pattern of Gene Transcripts")
#Change name of saved graphs file to a unique identifier
ggsave("../../../data/figures/grant_data16_nf5.pdf", evo_plot, width=30, height=30, limitsize=FALSE)
knitr::opts_chunk$set(echo = TRUE)
library(cowplot)
library(dplyr)
library(gridExtra)
library(ggplot2)
#Set working directory to the directory in which the results are contained in
setwd("../../results/2020_4_3/grant_data16_nf1.0_rep0_nmut3/")
all_sos_data <- read.table("sos_data.tsv", header=TRUE)
sos_data_acc <- all_sos_data %>% filter(Accepted=='yes')
sos_line_plot <- ggplot(sos_data_acc, aes(x=Iteration, y=Sum_of_Squares, color='red')) + geom_point(aes(color='red'), stat="identity") + geom_line(aes(color='red'), size= 1, stat="identity") + geom_line(data=all_sos_data, aes(x=Iteration, y=Sum_of_Squares), color='black') + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(color = "black")) + xlab("Sum of Squares") + ylab("Iteration")
sos_plots <- grid.arrange(sos_line_plot, nrow=1, top="Sum of Squares Data")
#Change name of sos_graphs to a unique identifier
ggsave("../../../data/figures/sos_graphs_grant_data16_nf1.pdf", sos_plots, width=20, height=10)
library(reshape2)
library(gridExtra)
library(gtools)
#Set working directory to the directory in which the results are contained in
setwd("../../results/2020_4_3/grant_data16_nf1.0_rep0_nmut3/")
plots_list <- list()
best_files <- list.files(pattern="three_genes_replicated_")
best_files <- mixedsort(sort(best_files))
plots_list <- list()
#Change grant_data name to the target file used
target_data <- read.table("../../../data/grant_data16.tsv", header=TRUE)
target_data <- filter(target_data, species == "protein1" | species == "protein2" | species == "protein3")
target_line_plot <-  ggplot(target_data, aes(fill=species, color=species, x=time, y=transcript)) + geom_line(stat="identity") + ggtitle("Target Genome Function") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
plots_list[[1]] <- target_line_plot
#Determines if there are too many accepted mutations and, if so, only display the last 20 that were accepted
starting_point <- 1
if (length(best_files) > 20){
starting_point <- length(best_files) - 20
}
plots_start <- 1
#Creates plots for each accepted mutation
for(i in starting_point:length(best_files)){
plots_start <- plots_start + 1
best <- "best"
best_plot <- "best_plot"
evolution_title <- "Genome Evolution "
plot_title <- paste(evolution_title, i, sep="")
file_name <- assign(paste(best, i, sep=""), read.table(best_files[i], fill=TRUE, header=TRUE))
file_name <- filter(file_name, species == "protein1" | species == "protein2" | species == "protein3")
plot_name <- assign(paste(best_plot, i, sep=""), ggplot(file_name, aes(fill=species, color=species, x=time, y=transcript)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black")) + geom_line(stat="identity") + ggtitle(plot_title))
plot <- ggplot(file_name, aes(fill=species, color=species, x=time, y=transcript)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black")) + geom_line(stat="identity") + ggtitle(plot_title)
plots_list[[plots_start]] <- plot
}
#Outputs file with the generated plots
evo_plot <- grid.arrange(grobs=plots_list, nrow=ceiling(length(plots_list) / 2), ncol=3, top="Evolutionary Pattern of Gene Transcripts")
#Change name of saved graphs file to a unique identifier
ggsave("../../../data/figures/grant_data16_nf1.pdf", evo_plot, width=30, height=30, limitsize=FALSE)
knitr::opts_chunk$set(echo = TRUE)
library(cowplot)
library(dplyr)
library(gridExtra)
library(ggplot2)
#Set working directory to the directory in which the results are contained in
setwd("../../results/2020_4_3/grant_data16_nf10.0_rep0_nmut3/")
all_sos_data <- read.table("sos_data.tsv", header=TRUE)
sos_data_acc <- all_sos_data %>% filter(Accepted=='yes')
sos_line_plot <- ggplot(sos_data_acc, aes(x=Iteration, y=Sum_of_Squares, color='red')) + geom_point(aes(color='red'), stat="identity") + geom_line(aes(color='red'), size= 1, stat="identity") + geom_line(data=all_sos_data, aes(x=Iteration, y=Sum_of_Squares), color='black') + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(color = "black")) + xlab("Sum of Squares") + ylab("Iteration")
sos_plots <- grid.arrange(sos_line_plot, nrow=1, top="Sum of Squares Data")
#Change name of sos_graphs to a unique identifier
ggsave("../../../data/figures/sos_graphs_grant_data16_nf10.pdf", sos_plots, width=20, height=10)
library(reshape2)
library(gridExtra)
library(gtools)
#Set working directory to the directory in which the results are contained in
setwd("../../results/2020_4_3/grant_data16_nf10.0_rep0_nmut3/")
plots_list <- list()
best_files <- list.files(pattern="three_genes_replicated_")
best_files <- mixedsort(sort(best_files))
plots_list <- list()
#Change grant_data name to the target file used
target_data <- read.table("../../../data/grant_data16.tsv", header=TRUE)
target_data <- filter(target_data, species == "protein1" | species == "protein2" | species == "protein3")
target_line_plot <-  ggplot(target_data, aes(fill=species, color=species, x=time, y=transcript)) + geom_line(stat="identity") + ggtitle("Target Genome Function") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
plots_list[[1]] <- target_line_plot
#Determines if there are too many accepted mutations and, if so, only display the last 20 that were accepted
starting_point <- 1
if (length(best_files) > 20){
starting_point <- length(best_files) - 20
}
plots_start <- 1
#Creates plots for each accepted mutation
for(i in starting_point:length(best_files)){
plots_start <- plots_start + 1
best <- "best"
best_plot <- "best_plot"
evolution_title <- "Genome Evolution "
plot_title <- paste(evolution_title, i, sep="")
file_name <- assign(paste(best, i, sep=""), read.table(best_files[i], fill=TRUE, header=TRUE))
file_name <- filter(file_name, species == "protein1" | species == "protein2" | species == "protein3")
plot_name <- assign(paste(best_plot, i, sep=""), ggplot(file_name, aes(fill=species, color=species, x=time, y=transcript)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black")) + geom_line(stat="identity") + ggtitle(plot_title))
plot <- ggplot(file_name, aes(fill=species, color=species, x=time, y=transcript)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black")) + geom_line(stat="identity") + ggtitle(plot_title)
plots_list[[plots_start]] <- plot
}
#Outputs file with the generated plots
evo_plot <- grid.arrange(grobs=plots_list, nrow=ceiling(length(plots_list) / 2), ncol=3, top="Evolutionary Pattern of Gene Transcripts")
#Change name of saved graphs file to a unique identifier
ggsave("../../../data/figures/grant_data16_nf10.pdf", evo_plot, width=30, height=30, limitsize=FALSE)
knitr::opts_chunk$set(echo = TRUE)
library(cowplot)
library(dplyr)
library(gridExtra)
library(ggplot2)
#Set working directory to the directory in which the results are contained in
setwd("../../results/2020_4_3/grant_data16_nf10.0_rep0_nmut3/")
knitr::opts_chunk$set(echo = TRUE)
library(cowplot)
library(dplyr)
library(gridExtra)
library(ggplot2)
#Set working directory to the directory in which the results are contained in
setwd("../../results/2020_4_5/grant_data16_nf10.0_rep0_nmut3/")
knitr::opts_chunk$set(echo = TRUE)
library(cowplot)
library(dplyr)
library(gridExtra)
library(ggplot2)
#Set working directory to the directory in which the results are contained in
setwd("../../results/2020_4_5/grant_data12_nf10.0_rep3_nmut1/")
all_sos_data <- read.table("sos_data.tsv", header=TRUE)
sos_data_acc <- all_sos_data %>% filter(Accepted=='yes')
sos_line_plot <- ggplot(sos_data_acc, aes(x=Iteration, y=Sum_of_Squares, color='red')) + geom_point(aes(color='red'), stat="identity") + geom_line(aes(color='red'), size= 1, stat="identity") + geom_line(data=all_sos_data, aes(x=Iteration, y=Sum_of_Squares), color='black') + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(color = "black")) + xlab("Sum of Squares") + ylab("Iteration")
sos_plots <- grid.arrange(sos_line_plot, nrow=1, top="Sum of Squares Data")
#Change name of sos_graphs to a unique identifier
ggsave("../../../data/figures/sos_graphs_grant_data16_nf10.pdf", sos_plots, width=20, height=10)
library(reshape2)
library(gridExtra)
library(gtools)
#Set working directory to the directory in which the results are contained in
setwd("../../results/2020_4_5/grant_data12_nf10.0_rep3_nmut1/")
plots_list <- list()
best_files <- list.files(pattern="three_genes_replicated_")
best_files <- mixedsort(sort(best_files))
plots_list <- list()
#Change grant_data name to the target file used
target_data <- read.table("../../../data/grant_data12.tsv", header=TRUE)
target_data <- filter(target_data, species == "protein1" | species == "protein2" | species == "protein3")
target_line_plot <-  ggplot(target_data, aes(fill=species, color=species, x=time, y=transcript)) + geom_line(stat="identity") + ggtitle("Target Genome Function") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
plots_list[[1]] <- target_line_plot
#Determines if there are too many accepted mutations and, if so, only display the last 20 that were accepted
starting_point <- 1
if (length(best_files) > 20){
starting_point <- length(best_files) - 20
}
plots_start <- 1
#Creates plots for each accepted mutation
for(i in starting_point:length(best_files)){
plots_start <- plots_start + 1
best <- "best"
best_plot <- "best_plot"
evolution_title <- "Genome Evolution "
plot_title <- paste(evolution_title, i, sep="")
file_name <- assign(paste(best, i, sep=""), read.table(best_files[i], fill=TRUE, header=TRUE))
file_name <- filter(file_name, species == "protein1" | species == "protein2" | species == "protein3")
plot_name <- assign(paste(best_plot, i, sep=""), ggplot(file_name, aes(fill=species, color=species, x=time, y=transcript)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black")) + geom_line(stat="identity") + ggtitle(plot_title))
plot <- ggplot(file_name, aes(fill=species, color=species, x=time, y=transcript)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black")) + geom_line(stat="identity") + ggtitle(plot_title)
plots_list[[plots_start]] <- plot
}
#Outputs file with the generated plots
evo_plot <- grid.arrange(grobs=plots_list, nrow=ceiling(length(plots_list) / 2), ncol=3, top="Evolutionary Pattern of Gene Transcripts")
#Change name of saved graphs file to a unique identifier
ggsave("../../../data/figures/grant_data12_nf10.pdf", evo_plot, width=30, height=30, limitsize=FALSE)
knitr::opts_chunk$set(echo = TRUE)
library(cowplot)
library(dplyr)
library(gridExtra)
library(ggplot2)
#Set working directory to the directory in which the results are contained in
setwd("../../results/2020_4_5/grant_data17_nf3.0_rep0_nmut3/")
all_sos_data <- read.table("sos_data.tsv", header=TRUE)
sos_data_acc <- all_sos_data %>% filter(Accepted=='yes')
sos_line_plot <- ggplot(sos_data_acc, aes(x=Iteration, y=Sum_of_Squares, color='red')) + geom_point(aes(color='red'), stat="identity") + geom_line(aes(color='red'), size= 1, stat="identity") + geom_line(data=all_sos_data, aes(x=Iteration, y=Sum_of_Squares), color='black') + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(color = "black")) + xlab("Sum of Squares") + ylab("Iteration")
sos_plots <- grid.arrange(sos_line_plot, nrow=1, top="Sum of Squares Data")
#Change name of sos_graphs to a unique identifier
ggsave("../../../data/figures/sos_graphs_grant_data17_nf3.pdf", sos_plots, width=20, height=10)
library(reshape2)
library(gridExtra)
library(gtools)
#Set working directory to the directory in which the results are contained in
setwd("../../results/2020_4_5/grant_data17_nf3.0_rep0_nmut3/")
plots_list <- list()
best_files <- list.files(pattern="three_genes_replicated_")
best_files <- mixedsort(sort(best_files))
plots_list <- list()
#Change grant_data name to the target file used
target_data <- read.table("../../../data/grant_data17.tsv", header=TRUE)
target_data <- filter(target_data, species == "protein1" | species == "protein2" | species == "protein3")
target_line_plot <-  ggplot(target_data, aes(fill=species, color=species, x=time, y=transcript)) + geom_line(stat="identity") + ggtitle("Target Genome Function") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
plots_list[[1]] <- target_line_plot
#Determines if there are too many accepted mutations and, if so, only display the last 20 that were accepted
starting_point <- 1
if (length(best_files) > 20){
starting_point <- length(best_files) - 20
}
plots_start <- 1
#Creates plots for each accepted mutation
for(i in starting_point:length(best_files)){
plots_start <- plots_start + 1
best <- "best"
best_plot <- "best_plot"
evolution_title <- "Genome Evolution "
plot_title <- paste(evolution_title, i, sep="")
file_name <- assign(paste(best, i, sep=""), read.table(best_files[i], fill=TRUE, header=TRUE))
file_name <- filter(file_name, species == "protein1" | species == "protein2" | species == "protein3")
plot_name <- assign(paste(best_plot, i, sep=""), ggplot(file_name, aes(fill=species, color=species, x=time, y=transcript)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black")) + geom_line(stat="identity") + ggtitle(plot_title))
plot <- ggplot(file_name, aes(fill=species, color=species, x=time, y=transcript)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black")) + geom_line(stat="identity") + ggtitle(plot_title)
plots_list[[plots_start]] <- plot
}
#Outputs file with the generated plots
evo_plot <- grid.arrange(grobs=plots_list, nrow=ceiling(length(plots_list) / 2), ncol=3, top="Evolutionary Pattern of Gene Transcripts")
#Change name of saved graphs file to a unique identifier
ggsave("../../../data/figures/grant_data17_nf3.pdf", evo_plot, width=30, height=30, limitsize=FALSE)
knitr::opts_chunk$set(echo = TRUE)
library(cowplot)
library(dplyr)
library(gridExtra)
library(ggplot2)
#Set working directory to the directory in which the results are contained in
setwd("../../results/2020_4_5/grant_data100_nf3.0_rep0_nmut1/")
all_sos_data <- read.table("sos_data.tsv", header=TRUE)
sos_data_acc <- all_sos_data %>% filter(Accepted=='yes')
sos_line_plot <- ggplot(sos_data_acc, aes(x=Iteration, y=Sum_of_Squares, color='red')) + geom_point(aes(color='red'), stat="identity") + geom_line(aes(color='red'), size= 1, stat="identity") + geom_line(data=all_sos_data, aes(x=Iteration, y=Sum_of_Squares), color='black') + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(color = "black")) + xlab("Sum of Squares") + ylab("Iteration")
sos_plots <- grid.arrange(sos_line_plot, nrow=1, top="Sum of Squares Data")
#Change name of sos_graphs to a unique identifier
ggsave("../../../data/figures/sos_graphs_grant_data100_nf3.pdf", sos_plots, width=20, height=10)
library(reshape2)
library(gridExtra)
library(gtools)
#Set working directory to the directory in which the results are contained in
setwd("../../results/2020_4_5/grant_data100_nf3.0_rep0_nmut1/")
plots_list <- list()
best_files <- list.files(pattern="three_genes_replicated_")
best_files <- mixedsort(sort(best_files))
plots_list <- list()
#Change grant_data name to the target file used
target_data <- read.table("../../../data/grant_data100.tsv", header=TRUE)
target_data <- filter(target_data, species == "protein1" | species == "protein2" | species == "protein3")
target_line_plot <-  ggplot(target_data, aes(fill=species, color=species, x=time, y=transcript)) + geom_line(stat="identity") + ggtitle("Target Genome Function") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
plots_list[[1]] <- target_line_plot
#Determines if there are too many accepted mutations and, if so, only display the last 20 that were accepted
starting_point <- 1
if (length(best_files) > 20){
starting_point <- length(best_files) - 20
}
plots_start <- 1
#Creates plots for each accepted mutation
for(i in starting_point:length(best_files)){
plots_start <- plots_start + 1
best <- "best"
best_plot <- "best_plot"
evolution_title <- "Genome Evolution "
plot_title <- paste(evolution_title, i, sep="")
file_name <- assign(paste(best, i, sep=""), read.table(best_files[i], fill=TRUE, header=TRUE))
file_name <- filter(file_name, species == "protein1" | species == "protein2" | species == "protein3")
plot_name <- assign(paste(best_plot, i, sep=""), ggplot(file_name, aes(fill=species, color=species, x=time, y=transcript)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black")) + geom_line(stat="identity") + ggtitle(plot_title))
plot <- ggplot(file_name, aes(fill=species, color=species, x=time, y=transcript)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black")) + geom_line(stat="identity") + ggtitle(plot_title)
plots_list[[plots_start]] <- plot
}
#Outputs file with the generated plots
evo_plot <- grid.arrange(grobs=plots_list, nrow=ceiling(length(plots_list) / 2), ncol=3, top="Evolutionary Pattern of Gene Transcripts")
#Change name of saved graphs file to a unique identifier
ggsave("../../../data/figures/grant_data100_nf3.pdf", evo_plot, width=30, height=30, limitsize=FALSE)
knitr::opts_chunk$set(echo = TRUE)
library(cowplot)
library(dplyr)
library(gridExtra)
library(ggplot2)
#Set working directory to the directory in which the results are contained in
setwd("../../results/2020_4_3/grant_data100_nf10_rep0_nmut1/")
all_sos_data <- read.table("sos_data.tsv", header=TRUE)
sos_data_acc <- all_sos_data %>% filter(Accepted=='yes')
sos_line_plot <- ggplot(sos_data_acc, aes(x=Iteration, y=Sum_of_Squares, color='red')) + geom_point(aes(color='red'), stat="identity") + geom_line(aes(color='red'), size= 1, stat="identity") + geom_line(data=all_sos_data, aes(x=Iteration, y=Sum_of_Squares), color='black') + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(color = "black")) + xlab("Sum of Squares") + ylab("Iteration")
sos_plots <- grid.arrange(sos_line_plot, nrow=1, top="Sum of Squares Data")
#Change name of sos_graphs to a unique identifier
ggsave("../../../data/figures/sos_graphs_grant_data100_nf3.pdf", sos_plots, width=20, height=10)
library(reshape2)
library(gridExtra)
library(gtools)
#Set working directory to the directory in which the results are contained in
setwd("../../results/2020_4_3/grant_data100_nf10_rep0_nmut1/")
plots_list <- list()
best_files <- list.files(pattern="three_genes_replicated_")
best_files <- mixedsort(sort(best_files))
plots_list <- list()
#Change grant_data name to the target file used
target_data <- read.table("../../../data/grant_data100.tsv", header=TRUE)
target_data <- filter(target_data, species == "protein1" | species == "protein2" | species == "protein3")
target_line_plot <-  ggplot(target_data, aes(fill=species, color=species, x=time, y=transcript)) + geom_line(stat="identity") + ggtitle("Target Genome Function") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
plots_list[[1]] <- target_line_plot
#Determines if there are too many accepted mutations and, if so, only display the last 20 that were accepted
starting_point <- 1
if (length(best_files) > 20){
starting_point <- length(best_files) - 20
}
plots_start <- 1
#Creates plots for each accepted mutation
for(i in starting_point:length(best_files)){
plots_start <- plots_start + 1
best <- "best"
best_plot <- "best_plot"
evolution_title <- "Genome Evolution "
plot_title <- paste(evolution_title, i, sep="")
file_name <- assign(paste(best, i, sep=""), read.table(best_files[i], fill=TRUE, header=TRUE))
file_name <- filter(file_name, species == "protein1" | species == "protein2" | species == "protein3")
plot_name <- assign(paste(best_plot, i, sep=""), ggplot(file_name, aes(fill=species, color=species, x=time, y=transcript)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black")) + geom_line(stat="identity") + ggtitle(plot_title))
plot <- ggplot(file_name, aes(fill=species, color=species, x=time, y=transcript)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black")) + geom_line(stat="identity") + ggtitle(plot_title)
plots_list[[plots_start]] <- plot
}
#Outputs file with the generated plots
evo_plot <- grid.arrange(grobs=plots_list, nrow=ceiling(length(plots_list) / 2), ncol=3, top="Evolutionary Pattern of Gene Transcripts")
#Change name of saved graphs file to a unique identifier
ggsave("../../../data/figures/grant_data100_rep0_nf10.pdf", evo_plot, width=30, height=30, limitsize=FALSE)
knitr::opts_chunk$set(echo = TRUE)
library(cowplot)
library(dplyr)
library(gridExtra)
library(ggplot2)
#Set working directory to the directory in which the results are contained in
setwd("../../results/2020_4_3/grant_data100_nf1_rep1_nmut3/")
all_sos_data <- read.table("sos_data.tsv", header=TRUE)
sos_data_acc <- all_sos_data %>% filter(Accepted=='yes')
sos_line_plot <- ggplot(sos_data_acc, aes(x=Iteration, y=Sum_of_Squares, color='red')) + geom_point(aes(color='red'), stat="identity") + geom_line(aes(color='red'), size= 1, stat="identity") + geom_line(data=all_sos_data, aes(x=Iteration, y=Sum_of_Squares), color='black') + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(color = "black")) + xlab("Sum of Squares") + ylab("Iteration")
sos_plots <- grid.arrange(sos_line_plot, nrow=1, top="Sum of Squares Data")
#Change name of sos_graphs to a unique identifier
ggsave("../../../data/figures/sos_graphs_grant_data100_rep1_nf3.pdf", sos_plots, width=20, height=10)
library(reshape2)
library(gridExtra)
library(gtools)
#Set working directory to the directory in which the results are contained in
setwd("../../results/2020_4_3/grant_data100_nf1_rep1_nmut3/")
plots_list <- list()
best_files <- list.files(pattern="three_genes_replicated_")
best_files <- mixedsort(sort(best_files))
plots_list <- list()
#Change grant_data name to the target file used
target_data <- read.table("../../../data/grant_data100.tsv", header=TRUE)
target_data <- filter(target_data, species == "protein1" | species == "protein2" | species == "protein3")
target_line_plot <-  ggplot(target_data, aes(fill=species, color=species, x=time, y=transcript)) + geom_line(stat="identity") + ggtitle("Target Genome Function") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
plots_list[[1]] <- target_line_plot
#Determines if there are too many accepted mutations and, if so, only display the last 20 that were accepted
starting_point <- 1
if (length(best_files) > 20){
starting_point <- length(best_files) - 20
}
plots_start <- 1
#Creates plots for each accepted mutation
for(i in starting_point:length(best_files)){
plots_start <- plots_start + 1
best <- "best"
best_plot <- "best_plot"
evolution_title <- "Genome Evolution "
plot_title <- paste(evolution_title, i, sep="")
file_name <- assign(paste(best, i, sep=""), read.table(best_files[i], fill=TRUE, header=TRUE))
file_name <- filter(file_name, species == "protein1" | species == "protein2" | species == "protein3")
plot_name <- assign(paste(best_plot, i, sep=""), ggplot(file_name, aes(fill=species, color=species, x=time, y=transcript)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black")) + geom_line(stat="identity") + ggtitle(plot_title))
plot <- ggplot(file_name, aes(fill=species, color=species, x=time, y=transcript)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black")) + geom_line(stat="identity") + ggtitle(plot_title)
plots_list[[plots_start]] <- plot
}
#Outputs file with the generated plots
evo_plot <- grid.arrange(grobs=plots_list, nrow=ceiling(length(plots_list) / 2), ncol=3, top="Evolutionary Pattern of Gene Transcripts")
#Change name of saved graphs file to a unique identifier
ggsave("../../../data/figures/grant_data100_rep1_nf10.pdf", evo_plot, width=30, height=30, limitsize=FALSE)
knitr::opts_chunk$set(echo = TRUE)
library(cowplot)
library(dplyr)
library(gridExtra)
library(ggplot2)
#Set working directory to the directory in which the results are contained in
setwd("../../results/2020_4_3/grant_data100_nf1_rep1_nmut3/")
all_sos_data <- read.table("sos_data.tsv", header=TRUE)
sos_data_acc <- all_sos_data %>% filter(Accepted=='yes')
sos_line_plot <- ggplot(sos_data_acc, aes(x=Iteration, y=Sum_of_Squares, color='red')) + geom_point(aes(color='red'), stat="identity") + geom_line(aes(color='red'), size= 1, stat="identity") + geom_line(data=all_sos_data, aes(x=Iteration, y=Sum_of_Squares), color='black') + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(color = "black")) + xlab("Sum of Squares") + ylab("Iteration")
sos_plots <- grid.arrange(sos_line_plot, nrow=1, top="Sum of Squares Data")
#Change name of sos_graphs to a unique identifier
ggsave("../../../data/figures/sos_graphs_grant_data100_rep1_nf1.pdf", sos_plots, width=20, height=10)
library(reshape2)
library(gridExtra)
library(gtools)
#Set working directory to the directory in which the results are contained in
setwd("../../results/2020_4_3/grant_data100_nf1_rep1_nmut3/")
plots_list <- list()
best_files <- list.files(pattern="three_genes_replicated_")
best_files <- mixedsort(sort(best_files))
plots_list <- list()
#Change grant_data name to the target file used
target_data <- read.table("../../../data/grant_data100.tsv", header=TRUE)
target_data <- filter(target_data, species == "protein1" | species == "protein2" | species == "protein3")
target_line_plot <-  ggplot(target_data, aes(fill=species, color=species, x=time, y=transcript)) + geom_line(stat="identity") + ggtitle("Target Genome Function") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
plots_list[[1]] <- target_line_plot
#Determines if there are too many accepted mutations and, if so, only display the last 20 that were accepted
starting_point <- 1
if (length(best_files) > 20){
starting_point <- length(best_files) - 20
}
plots_start <- 1
#Creates plots for each accepted mutation
for(i in starting_point:length(best_files)){
plots_start <- plots_start + 1
best <- "best"
best_plot <- "best_plot"
evolution_title <- "Genome Evolution "
plot_title <- paste(evolution_title, i, sep="")
file_name <- assign(paste(best, i, sep=""), read.table(best_files[i], fill=TRUE, header=TRUE))
file_name <- filter(file_name, species == "protein1" | species == "protein2" | species == "protein3")
plot_name <- assign(paste(best_plot, i, sep=""), ggplot(file_name, aes(fill=species, color=species, x=time, y=transcript)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black")) + geom_line(stat="identity") + ggtitle(plot_title))
plot <- ggplot(file_name, aes(fill=species, color=species, x=time, y=transcript)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black")) + geom_line(stat="identity") + ggtitle(plot_title)
plots_list[[plots_start]] <- plot
}
#Outputs file with the generated plots
evo_plot <- grid.arrange(grobs=plots_list, nrow=ceiling(length(plots_list) / 2), ncol=3, top="Evolutionary Pattern of Gene Transcripts")
#Change name of saved graphs file to a unique identifier
ggsave("../../../data/figures/grant_data100_rep1_nf1.pdf", evo_plot, width=30, height=30, limitsize=FALSE)
knitr::opts_chunk$set(echo = TRUE)
library(cowplot)
library(dplyr)
library(gridExtra)
library(ggplot2)
#Set working directory to the directory in which the results are contained in
setwd("../../results/2020_4_3/grant_data100_nf10_rep2_nmut3/")
all_sos_data <- read.table("sos_data.tsv", header=TRUE)
sos_data_acc <- all_sos_data %>% filter(Accepted=='yes')
sos_line_plot <- ggplot(sos_data_acc, aes(x=Iteration, y=Sum_of_Squares, color='red')) + geom_point(aes(color='red'), stat="identity") + geom_line(aes(color='red'), size= 1, stat="identity") + geom_line(data=all_sos_data, aes(x=Iteration, y=Sum_of_Squares), color='black') + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(color = "black")) + xlab("Sum of Squares") + ylab("Iteration")
sos_plots <- grid.arrange(sos_line_plot, nrow=1, top="Sum of Squares Data")
#Change name of sos_graphs to a unique identifier
ggsave("../../../data/figures/sos_graphs_grant_data100_rep2_nf10.pdf", sos_plots, width=20, height=10)
library(reshape2)
library(gridExtra)
library(gtools)
#Set working directory to the directory in which the results are contained in
setwd("../../results/2020_4_3/grant_data100_nf10_rep2_nmut3/")
plots_list <- list()
best_files <- list.files(pattern="three_genes_replicated_")
best_files <- mixedsort(sort(best_files))
plots_list <- list()
#Change grant_data name to the target file used
target_data <- read.table("../../../data/grant_data100.tsv", header=TRUE)
target_data <- filter(target_data, species == "protein1" | species == "protein2" | species == "protein3")
target_line_plot <-  ggplot(target_data, aes(fill=species, color=species, x=time, y=transcript)) + geom_line(stat="identity") + ggtitle("Target Genome Function") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
plots_list[[1]] <- target_line_plot
#Determines if there are too many accepted mutations and, if so, only display the last 20 that were accepted
starting_point <- 1
if (length(best_files) > 20){
starting_point <- length(best_files) - 20
}
plots_start <- 1
#Creates plots for each accepted mutation
for(i in starting_point:length(best_files)){
plots_start <- plots_start + 1
best <- "best"
best_plot <- "best_plot"
evolution_title <- "Genome Evolution "
plot_title <- paste(evolution_title, i, sep="")
file_name <- assign(paste(best, i, sep=""), read.table(best_files[i], fill=TRUE, header=TRUE))
file_name <- filter(file_name, species == "protein1" | species == "protein2" | species == "protein3")
plot_name <- assign(paste(best_plot, i, sep=""), ggplot(file_name, aes(fill=species, color=species, x=time, y=transcript)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black")) + geom_line(stat="identity") + ggtitle(plot_title))
plot <- ggplot(file_name, aes(fill=species, color=species, x=time, y=transcript)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black")) + geom_line(stat="identity") + ggtitle(plot_title)
plots_list[[plots_start]] <- plot
}
#Outputs file with the generated plots
evo_plot <- grid.arrange(grobs=plots_list, nrow=ceiling(length(plots_list) / 2), ncol=3, top="Evolutionary Pattern of Gene Transcripts")
#Change name of saved graphs file to a unique identifier
ggsave("../../../data/figures/grant_data100_rep2_nf10.pdf", evo_plot, width=30, height=30, limitsize=FALSE)
