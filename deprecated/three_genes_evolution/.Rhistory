getwd()
myfiles <- list.files("/sahilshah/Desktop/pinetree-toys/three_genes_evolution/best_replicated_gen_")
myfiles
myfiles <- list.files("/sahilshah/Desktop/pinetree-toys/three_genes_evolution/")
myfiles
list.files(path=myfiles, pattern="best_replicated_gen_")
myfiles <- list.files("/sahilshah/Desktop/pinetree-toys/three_genes_evolution/", full.names = TRUE)
list.files(path=myfiles, pattern="best_replicated_gen_")
files <- list.files("/sahilshah/Desktop/pinetree-toys/three_genes_evolution/", pattern="best_replicated_gen_")
files <- list.files("/sahilshah/Desktop/pinetree-toys/three_genes_evolution/", pattern="best_replicated_gen")
getwd()
files <- list.files("/Users/sahilshah/Desktop/pinetree-toys/three_genes_evolution/", pattern="best_replicated_gen")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
#knitr::opts_chunk$set(echo = TRUE)
library(cowplot)
install.packages("cowplot")
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_chunk$set(echo = TRUE)
library(cowplot)
library(dplyr)
install.packages("dplyr")
install.packages("dplyr")
install.packages("dplyr")
install.packages("gridExtra")
install.packages("tidyverse")
install.packages("tidyverse")
install.packages("tidyverse")
install.packages("tidyverse")
install.packages("tidyverse")
install.packages("tidyverse")
install.packages("tidyverse")
install.packages("dplyr")
install.packages("ggplot2")
knitr::opts_chunk$set(echo = TRUE)
library(cowplot)
knitr::opts_chunk$set(echo = TRUE)
library(cowplot)
remove.packages("ggplot2")
library(cowplot)
install.packages("ggplot2")
library(cowplot)
install.packages("cowplot")
library(cowplot)
knitr::opts_chunk$set(echo = TRUE)
install.packages(c("cowplot", "dplyr", "ggplot2", "gridExtra", "gtools", "knitr"))
library(cowplot)
library(dplyr)
library(gridExtra)
library(ggplot2)
library(gtools)
#Final genome data
setwd("/home/sahil/pinetree-toys/three_genes_evolution/")
genome <- read.table("gene_tracker.tsv", header=TRUE)
genome[4, 1]
genome[4, 2]
genome[4, 3]
#Draw promoters
if((genome[4, 2] >= 122) & (genome[4, 3] <= 132)){
draw_prom1_r1a <- geom_segment(mapping=aes(x=12, y=1.5, xend=12, yend=2))
draw_prom1_r2a <- geom_segment(mapping=aes(x=12, y=2, xend=13, yend=2), arrow = arrow(length = unit(0.5, "cm")))
} else {
draw_prom1_r1a <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
draw_prom1_r2a <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
}
if((genome[4, 2] >= 133) & (genome[4, 3] <= 143)){
draw_prom1_r1b <- geom_segment(mapping=aes(x=15, y=1.5, xend=15, yend=2))
draw_prom1_r2b <- geom_segment(mapping=aes(x=15, y=2, xend=16, yend=2), arrow = arrow(length = unit(0.5, "cm")))
} else {
draw_prom1_r1b <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
draw_prom1_r2b <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
}
if((genome[5, 2] >= 281) & genome[5, 3] <= 291){
draw_prom2_r1a <- geom_segment(mapping=aes(x=32, y=1.5, xend=32, yend=2))
draw_prom2_r2a <- geom_segment(mapping=aes(x=32, y=2, xend=33, yend=2), arrow = arrow(length = unit(0.5, "cm")))
} else {
draw_prom2_r1a <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
draw_prom2_r2a <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
}
if((genome[5, 2] >= 292) & genome[5, 3] <= 302){
draw_prom2_r1b <- geom_segment(mapping=aes(x=35, y=1.5, xend=35, yend=2))
draw_prom2_r2b <- geom_segment(mapping=aes(x=35, y=2, xend=36, yend=2), arrow = arrow(length = unit(0.5, "cm")))
} else {
draw_prom2_r1b <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
draw_prom2_r2b <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
}
#Draw terminators
if((genome[10, 2] >= 122) & (genome[10, 3] <= 132)){
draw_term1_r1a <- geom_segment(mapping=aes(x=12, y=1.5, xend=12, yend=1.75))
draw_term1_r2a <- geom_segment(mapping=aes(x=11, y=1.75, xend=13, yend=1.75))
} else {
draw_term1_r1a <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
draw_term1_r2a <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
}
if((genome[10, 2] >= 133) & (genome[10, 3] <= 143)){
draw_term1_r1b <- geom_segment(mapping=aes(x=15, y=1.5, xend=15, yend=1.75))
draw_term1_r2b <- geom_segment(mapping=aes(x=14, y=1.75, xend=16, yend=1.75))
} else {
draw_term1_r1b <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
draw_term1_r2b <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
}
if((genome[10, 2] >= 144) & (genome[10, 3] <= 159)){
draw_term1_r1c <- geom_segment(mapping=aes(x=18, y=1.5, xend=18, yend=1.75))
draw_term1_r2c <- geom_segment(mapping=aes(x=17, y=1.75, xend=19, yend=1.75))
} else {
draw_term1_r1c <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
draw_term1_r2c <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
}
if((genome[11, 2] >= 281) & (genome[11, 3] <= 291)){
draw_term2_r1a <- geom_segment(mapping=aes(x=32, y=1.5, xend=32, yend=1.75))
draw_term2_r2a <- geom_segment(mapping=aes(x=31, y=1.75, xend=33, yend=1.75))
} else {
draw_term2_r1a <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
draw_term2_r2a <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
}
if((genome[11, 2] >= 292) & (genome[11, 3] <= 302)){
draw_term2_r1b <- geom_segment(mapping=aes(x=35, y=1.5, xend=35, yend=1.75))
draw_term2_r2b <- geom_segment(mapping=aes(x=34, y=1.75, xend=36, yend=1.75))
} else {
draw_term2_r1b <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
draw_term2_r2b <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
}
if((genome[11, 2] >= 303) & (genome[11, 3] <= 318)){
draw_term2_r1c <- geom_segment(mapping=aes(x=38, y=1.5, xend=38, yend=1.75))
draw_term2_r2c <- geom_segment(mapping=aes(x=37, y=1.75, xend=39, yend=1.75))
} else {
draw_term2_r1c <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
draw_term2_r2c <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
}
if(genome[12, 2] > 0){
draw_term3a <- geom_segment(mapping=aes(x=50, y=2, xend=50, yend=2.25))
draw_term3b <- geom_segment(mapping=aes(x=47, y=2.25, xend=53, yend=2.25))
} else {
draw_term3a <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
draw_term3b <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
}
#Draw rnases (first segment, region a within first rnase placement)
if((genome[7, 2] >= 11) & (genome[7, 3] <= 25)){
draw_rnase1a <- geom_segment(mapping=(aes(x=1, y=2.1, xend=3, yend=2)))
draw_rnase1b <- geom_segment(mapping=(aes(x=3, y=2.1, xend=1, yend=2)))
}else{
draw_rnase1a <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
draw_rnase1b <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
}
if((genome[8, 2] >= 122) & (genome[8, 3] <= 132)){
draw_rnase2_r1a <- geom_segment(mapping=aes(x=11, y=1.7, xend=13, yend=1.3))
draw_rnase2_r2a <- geom_segment(mapping=aes(x=13, y=1.7, xend=11, yend=1.3))
}else{
draw_rnase2_r1a <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
draw_rnase2_r2a <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
}
if((genome[8, 2] >= 133) & (genome[8, 3] <= 143)){
draw_rnase2_r1b <- geom_segment(mapping=aes(x=14, y=1.7, xend=16, yend=1.3))
draw_rnase2_r2b <- geom_segment(mapping=aes(x=16, y=1.7, xend=14, yend=1.3))
}else{
draw_rnase2_r1b <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
draw_rnase2_r2b <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
}
if((genome[8, 2] >= 144) & (genome[8, 3] <= 159)){
draw_rnase2_r1c <- geom_segment(mapping=aes(x=17, y=1.7, xend=19, yend=1.3))
draw_rnase2_r2c <- geom_segment(mapping=aes(x=19, y=1.7, xend=17, yend=1.3))
} else {
draw_rnase2_r1c <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
draw_rnase2_r2c <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
}
if((genome[9, 2] >= 281) & (genome[9, 3] <= 291)){
draw_rnase3_r1a <- geom_segment(mapping=aes(x=31, y=1.7, xend=33, yend=1.3))
draw_rnase3_r2a <- geom_segment(mapping=aes(x=33, y=1.7, xend=31, yend=1.3))
}else{
draw_rnase3_r1a <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
draw_rnase3_r2a <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
}
if((genome[9, 2] >= 292) & (genome[9, 3] <= 302)){
draw_rnase3_r1b <- geom_segment(mapping=aes(x=34, y=1.7, xend=36, yend=1.3))
draw_rnase3_r2b <- geom_segment(mapping=aes(x=36, y=1.7, xend=34, yend=1.3))
}else{
draw_rnase3_r1b <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
draw_rnase3_r2b <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
}
if((genome[9, 2] >= 303) & (genome[9, 3] <= 318)){
draw_rnase3_r1c <- geom_segment(mapping=aes(x=37, y=1.7, xend=39, yend=1.3))
draw_rnase3_r2c <- geom_segment(mapping=aes(x=39, y=1.7, xend=37, yend=1.3))
}else{
draw_rnase3_r1c <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
draw_rnase3_r2c <- geom_segment(mapping=aes(x=0, y=0, xend=0, yend=0))
}
genome_list <- list(draw_prom1_r1a, draw_prom1_r2a, draw_prom1_r1b, draw_prom1_r2b, draw_prom2_r1a, draw_prom2_r2a, draw_prom2_r1b, draw_prom2_r2b, draw_term1_r1a, draw_term1_r2a, draw_term1_r1b, draw_term1_r2b, draw_term1_r1c, draw_term1_r2c, draw_term2_r1a, draw_term2_r2a, draw_term2_r1b, draw_term2_r2b, draw_term2_r1c, draw_term2_r2c, draw_term3a, draw_term3b, draw_rnase1a, draw_rnase1b, draw_rnase2_r1a, draw_rnase2_r2a, draw_rnase2_r1b, draw_rnase2_r2b, draw_rnase2_r1c, draw_rnase2_r2c, draw_rnase3_r1a, draw_rnase3_r2a, draw_rnase3_r1b, draw_rnase3_r2b, draw_rnase3_r1c, draw_rnase3_r2c)
final_genome_plot <- ggplot() + ggtitle("Final Genome Architecture") + geom_rect(data=gene1, mapping=aes(xmin=1, xmax=10, ymin=y1, ymax=y2), fill="blue", alpha=0.5) + geom_rect(data=gene2, mapping=aes(xmin=20, xmax=30, ymin=y1, ymax=y2), fill="red", alpha=0.5) + geom_rect(data=gene3, mapping=aes(xmin=40, xmax=50, ymin=y1, ymax=y2), fill="yellow", alpha=0.5) + geom_segment(mapping=aes(x=1, y=2, xend=1, yend=2.5), col="black") + geom_segment(mapping=aes(x=30, y=1.5, xend=40, yend=1.5)) + geom_segment(mapping=aes(x=10, y=1.5, xend=20, yend=1.5), color="black") + geom_segment(mapping=aes(x=1, y=2.5, xend=3, yend=2.5), color="black", arrow = arrow(length = unit(0.5, "cm"))) + draw_prom1_r1a + draw_prom1_r2a + draw_prom1_r1b + draw_prom1_r2b + draw_prom2_r1a + draw_prom2_r2a + draw_prom2_r1b + draw_prom2_r2b + draw_term1_r1a + draw_term1_r2a + draw_term1_r1b + draw_term1_r2b + draw_term1_r1c + draw_term1_r2c + draw_term2_r1a + draw_term2_r2a + draw_term2_r1b + draw_term2_r2b + draw_term2_r1c + draw_term2_r2c + draw_term3a + draw_term3b + draw_rnase1a + draw_rnase1b + draw_rnase2_r1a + draw_rnase2_r2a + draw_rnase2_r1b + draw_rnase2_r2b + draw_rnase2_r1c + draw_rnase2_r2c + draw_rnase3_r1a + draw_rnase3_r2a + draw_rnase3_r1b + draw_rnase3_r2b + draw_rnase3_r1c + draw_rnase3_r2c
genome_list <- list(draw_prom1_r1a, draw_prom1_r2a, draw_prom1_r1b, draw_prom1_r2b, draw_prom2_r1a, draw_prom2_r2a, draw_prom2_r1b, draw_prom2_r2b, draw_term1_r1a, draw_term1_r2a, draw_term1_r1b, draw_term1_r2b, draw_term1_r1c, draw_term1_r2c, draw_term2_r1a, draw_term2_r2a, draw_term2_r1b, draw_term2_r2b, draw_term2_r1c, draw_term2_r2c, draw_term3a, draw_term3b, draw_rnase1a, draw_rnase1b, draw_rnase2_r1a, draw_rnase2_r2a, draw_rnase2_r1b, draw_rnase2_r2b, draw_rnase2_r1c, draw_rnase2_r2c, draw_rnase3_r1a, draw_rnase3_r2a, draw_rnase3_r1b, draw_rnase3_r2b, draw_rnase3_r1c, draw_rnase3_r2c)
final_genome_plot <- ggplot() + ggtitle("Final Genome Architecture") + geom_rect(data=genome, mapping=aes(xmin=1, xmax=10, ymin=y1, ymax=y2), fill="blue", alpha=0.5) + geom_rect(data=genome, mapping=aes(xmin=20, xmax=30, ymin=y1, ymax=y2), fill="red", alpha=0.5) + geom_rect(data=genome, mapping=aes(xmin=40, xmax=50, ymin=y1, ymax=y2), fill="yellow", alpha=0.5) + geom_segment(mapping=aes(x=1, y=2, xend=1, yend=2.5), col="black") + geom_segment(mapping=aes(x=30, y=1.5, xend=40, yend=1.5)) + geom_segment(mapping=aes(x=10, y=1.5, xend=20, yend=1.5), color="black") + geom_segment(mapping=aes(x=1, y=2.5, xend=3, yend=2.5), color="black", arrow = arrow(length = unit(0.5, "cm"))) + draw_prom1_r1a + draw_prom1_r2a + draw_prom1_r1b + draw_prom1_r2b + draw_prom2_r1a + draw_prom2_r2a + draw_prom2_r1b + draw_prom2_r2b + draw_term1_r1a + draw_term1_r2a + draw_term1_r1b + draw_term1_r2b + draw_term1_r1c + draw_term1_r2c + draw_term2_r1a + draw_term2_r2a + draw_term2_r1b + draw_term2_r2b + draw_term2_r1c + draw_term2_r2c + draw_term3a + draw_term3b + draw_rnase1a + draw_rnase1b + draw_rnase2_r1a + draw_rnase2_r2a + draw_rnase2_r1b + draw_rnase2_r2b + draw_rnase2_r1c + draw_rnase2_r2c + draw_rnase3_r1a + draw_rnase3_r2a + draw_rnase3_r1b + draw_rnase3_r2b + draw_rnase3_r1c + draw_rnase3_r2c
final_genome_plot
y1 = 1
y2 = 2
final_genome_plot <- ggplot() + ggtitle("Final Genome Architecture") + geom_rect(data=genome, mapping=aes(xmin=1, xmax=10, ymin=y1, ymax=y2), fill="blue", alpha=0.5) + geom_rect(data=genome, mapping=aes(xmin=20, xmax=30, ymin=y1, ymax=y2), fill="red", alpha=0.5) + geom_rect(data=genome, mapping=aes(xmin=40, xmax=50, ymin=y1, ymax=y2), fill="yellow", alpha=0.5) + geom_segment(mapping=aes(x=1, y=2, xend=1, yend=2.5), col="black") + geom_segment(mapping=aes(x=30, y=1.5, xend=40, yend=1.5)) + geom_segment(mapping=aes(x=10, y=1.5, xend=20, yend=1.5), color="black") + geom_segment(mapping=aes(x=1, y=2.5, xend=3, yend=2.5), color="black", arrow = arrow(length = unit(0.5, "cm"))) + draw_prom1_r1a + draw_prom1_r2a + draw_prom1_r1b + draw_prom1_r2b + draw_prom2_r1a + draw_prom2_r2a + draw_prom2_r1b + draw_prom2_r2b + draw_term1_r1a + draw_term1_r2a + draw_term1_r1b + draw_term1_r2b + draw_term1_r1c + draw_term1_r2c + draw_term2_r1a + draw_term2_r2a + draw_term2_r1b + draw_term2_r2b + draw_term2_r1c + draw_term2_r2c + draw_term3a + draw_term3b + draw_rnase1a + draw_rnase1b + draw_rnase2_r1a + draw_rnase2_r2a + draw_rnase2_r1b + draw_rnase2_r2b + draw_rnase2_r1c + draw_rnase2_r2c + draw_rnase3_r1a + draw_rnase3_r2a + draw_rnase3_r1b + draw_rnase3_r2b + draw_rnase3_r1c + draw_rnase3_r2c
final_genome_plot
